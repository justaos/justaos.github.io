{"version":3,"sources":["src/3d-party/prism/index.tsx","src/components/content/code-highlighter/code-highlighter.scss?tag=goat-code-highlighter&encapsulation=shadow","src/components/content/code-highlighter/code-highlighter.tsx"],"names":["PRISM_VERSION","async","loadPrism","loadScript","codeHighlighterCss","Language","CodeHighlighter","this","parsedValue","javascript","[object Object]","renderPrism","window","Prism","autoloader","plugins","all","key","push","loadLanguages","setTimeout","str","replace","value","elm","innerHTML","decode","trim","formatted","highlight","languages","language","lineNumbersWrapper","lineNumbers","linesNum","split","length","lines","Array","join","compiledCode","navigator","clipboard","writeText","alert","h","Host","class","line-numbers-wrapper","line-numbers","dir","size","variant","aria-label","title","onGoat:click","handleCopyClick","name"],"mappings":"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","sourcesContent":["import { loadScript } from '../../utils/utils';\n\nexport const PRISM_VERSION = '1.27.0';\n\nexport async function loadPrism() {\n  // @ts-ignore\n  await loadScript(`https://cdnjs.cloudflare.com/ajax/libs/prism/${PRISM_VERSION}/components/prism-core.min.js`);\n  await loadScript(`https://cdnjs.cloudflare.com/ajax/libs/prism/${PRISM_VERSION}/plugins/autoloader/prism-autoloader.min.js`);\n}\n","@import \"../../../3d-party/prism/prism\";\r\n@import \"../../../3d-party/prism/prism-line-numbers\";\r\n@import \"../../../globalStyles/commons\";\r\n\r\n\r\n:host {\r\n  display: block;\r\n  height: 100%;\r\n}\r\n\r\n.code-loader {\r\n  height: 20rem;\r\n  background-color: v(--field-01);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: v(--spacing-2);\r\n}\r\n\r\n.code-highlighter {\r\n  position: relative;\r\n  height: 100%;\r\n  background-color: v(--color-brand-primary-10);\r\n  padding: v(--spacing-3);\r\n  color: v(--text-primary);\r\n\r\n  .scroll-wrapper {\r\n    height: 100%;\r\n    overflow-y: auto;\r\n    .line-numbers-wrapper {\r\n      height: 100%;\r\n      position: relative;\r\n\r\n      &.line-numbers {\r\n        margin-left: 3.8rem;\r\n      }\r\n\r\n      @include font-style(text-sm);\r\n      .highlighter {\r\n        margin: 0;\r\n        padding: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  .copy-btn {\r\n    position: absolute;\r\n    top: v(--spacing-3);\r\n    right: v(--spacing-3);\r\n  }\r\n\r\n}\r\n\r\n\r\n:host-context([data-theme=\"dark\"]) .code-highlighter {\r\n  background-color: v(--color-brand-primary-100);\r\n}\r\n","import { Component, ComponentInterface, Element, h, Host, Prop, State, Watch } from '@stencil/core';\nimport { loadPrism } from '../../../3d-party/prism';\n\nenum Language {\n  markup = 'markup',\n  css = 'css',\n  clike = 'clike',\n  javascript = 'javascript',\n  abap = 'abap',\n  actionscript = 'actionscript',\n  ada = 'ada',\n  apacheconf = 'apacheconf',\n  apl = 'apl',\n  applescript = 'applescript',\n  arduino = 'arduino',\n  arff = 'arff',\n  asciidoc = 'asciidoc',\n  asm6502 = 'asm6502',\n  aspnet = 'aspnet',\n\n  autohotkey = 'autohotkey',\n  autoit = 'autoit',\n  bash = 'bash',\n  basic = 'basic',\n  batch = 'batch',\n  bison = 'bison',\n  brainfuck = 'brainfuck',\n  bro = 'bro',\n  c = 'c',\n  csharp = 'csharp',\n  cpp = 'cpp',\n  coffeescript = 'coffeescript',\n  clojure = 'clojure',\n  crystal = 'crystal',\n  csp = 'csp',\n  cssExtras = 'css-extras',\n  d = 'd',\n  dart = 'dart',\n  diff = 'diff',\n  django = 'django',\n  docker = 'docker',\n  eiffel = 'eiffel',\n  elixir = 'elixir',\n  elm = 'elm',\n  erb = 'erb',\n  erlang = 'erlang',\n  fsharp = 'fsharp',\n  flow = 'flow',\n  fortran = 'fortran',\n  gedcom = 'gedcom',\n  gherkin = 'gherkin',\n  git = 'git',\n  glsl = 'glsl',\n  go = 'go',\n  graphql = 'graphql',\n  groovy = 'groovy',\n  haml = 'haml',\n  handlebars = 'handlebars',\n  haskell = 'haskell',\n  haxe = 'haxe',\n  http = 'http',\n  hpkp = 'hpkp',\n  hsts = 'hsts',\n  ichigojam = 'ichigojam',\n  icon = 'icon',\n  inform7 = 'inform7',\n  ini = 'ini',\n  io = 'io',\n  j = 'j',\n  java = 'java',\n  jolie = 'jolie',\n  json = 'json',\n  jsx = 'jsx',\n  julia = 'julia',\n\n  keyman = 'keyman',\n  kotlin = 'kotlin',\n  latex = 'latex',\n  less = 'less',\n  lilypond = 'lilypond',\n  liquid = 'liquid',\n  lisp = 'lisp',\n  livescript = 'livescript',\n  lolcode = 'lolcode',\n  lua = 'lua',\n  makefile = 'makefile',\n  markdown = 'markdown',\n  markupTemplating = 'markup-templating',\n  matlab = 'matlab',\n  mel = 'mel',\n  mizar = 'mizar',\n  monkey = 'monkey',\n  n4js = 'n4js',\n  nasm = 'nasm',\n  nginx = 'nginx',\n  nim = 'nim',\n  nix = 'nix',\n  nsis = 'nsis',\n  objectivec = 'objectivec',\n  ocaml = 'ocaml',\n  opencl = 'opencl',\n  oz = 'oz',\n  parigp = 'parigp',\n  parser = 'parser',\n  pascal = 'pascal',\n  perl = 'perl',\n  php = 'php',\n  phpExtras = 'php-extras',\n  plsql = 'plsql',\n  powershell = 'powershell',\n  processing = 'processing',\n  prolog = 'prolog',\n  properties = 'properties',\n  protobuf = 'protobuf',\n  pug = 'pug',\n  puppet = 'puppet',\n  pure = 'pure',\n  python = 'python',\n  q = 'q',\n  qore = 'qore',\n  r = 'r',\n}\n\n\n/**\n * @name Code Highlighter\n * @description A browser based code highlighter.\n * @img /assets/img/code-highlighter.png\n */\n@Component({\n  tag: 'goat-code-highlighter',\n  styleUrl: 'code-highlighter.scss',\n  shadow: true,\n})\nexport class CodeHighlighter implements ComponentInterface {\n\n\n  @Prop() language: string = Language.javascript;\n\n  @Prop() lineNumbers: boolean = false;\n\n  @Prop() value: string = '';\n\n  @State() compiledCode: string = '';\n\n  private parsedValue: string = '';\n\n  @Watch('language')\n  languageWatcher() {\n    this.renderPrism();\n  }\n\n  @Watch('lineNumbers')\n  themeWatcher() {\n    this.renderPrism();\n  }\n\n\n  @Element() elm!: HTMLElement;\n\n  async componentWillLoad() {\n    if (!window['Prism']) {\n      await loadPrism();\n      // @ts-ignore\n      const Prism = window['Prism'];\n      const autoloader = Prism.plugins.autoloader;\n      if (autoloader) {\n        const all = [];\n        for (const key in Language) {\n          all.push(Language[key]);\n        }\n        autoloader.loadLanguages(all);\n      }\n    }\n  }\n\n  componentDidLoad() {\n    setTimeout(() => this.renderPrism(), 1000);\n  }\n\n  decode(str: string) {\n    return str.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n  }\n\n  private renderPrism() {\n    // @ts-ignore\n    const Prism = window['Prism'];\n\n    let value = this.value;\n    if (!value) {\n      value = this.elm.innerHTML;\n    }\n    value = this.decode(value);\n    this.parsedValue = value.trim();\n    const formatted = Prism.highlight(this.parsedValue, Prism.languages[this.language], this.language);\n    let lineNumbersWrapper = '';\n    if (this.lineNumbers) {\n      const linesNum = formatted.split('\\n').length;\n      const lines = new Array(linesNum + 1).join('<span></span>');\n      lineNumbersWrapper = `<span aria-hidden='true' class='line-numbers-rows'>${lines}</span>`;\n    }\n    this.compiledCode = formatted + lineNumbersWrapper;\n  }\n\n  handleCopyClick() {\n    window.navigator.clipboard.writeText(this.parsedValue);\n    alert('copied');\n  }\n\n  render() {\n    return (\n      <Host>\n        {this.compiledCode && <div class='code-highlighter'>\n          <div class='scroll-wrapper'>\n            <div class={{ 'line-numbers-wrapper': true, 'line-numbers': this.lineNumbers }}>\n              <pre dir='ltr' class='highlighter line-numbers' innerHTML={this.compiledCode} />\n            </div>\n          </div>\n          <goat-button class='copy-btn color-secondary icon-only'\n                       size='sm'\n                       variant='ghost'\n                       aria-label='Copy code'\n                       title='Copy code' onGoat:click={() => {\n            this.handleCopyClick();\n          }}>\n            <goat-icon name='files' size='1rem' />\n          </goat-button>\n\n        </div>}\n        {!this.compiledCode && <div class='code-loader'>\n          <goat-spinner class='rainbow' />\n          Loading code...\n        </div>}\n      </Host>\n    );\n  }\n\n}\n"]}