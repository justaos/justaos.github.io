{"version":3,"file":"code-highlighter.js","sourceRoot":"","sources":["../../../../src/components/content/code-highlighter/code-highlighter.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, ComponentInterface, Element, h, Host, Prop, State, Watch } from '@stencil/core';\nimport { loadPrism } from '../../../3d-party/prism';\n\nenum Language {\n  markup = 'markup',\n  css = 'css',\n  clike = 'clike',\n  javascript = 'javascript',\n  abap = 'abap',\n  actionscript = 'actionscript',\n  ada = 'ada',\n  apacheconf = 'apacheconf',\n  apl = 'apl',\n  applescript = 'applescript',\n  arduino = 'arduino',\n  arff = 'arff',\n  asciidoc = 'asciidoc',\n  asm6502 = 'asm6502',\n  aspnet = 'aspnet',\n\n  autohotkey = 'autohotkey',\n  autoit = 'autoit',\n  bash = 'bash',\n  basic = 'basic',\n  batch = 'batch',\n  bison = 'bison',\n  brainfuck = 'brainfuck',\n  bro = 'bro',\n  c = 'c',\n  csharp = 'csharp',\n  cpp = 'cpp',\n  coffeescript = 'coffeescript',\n  clojure = 'clojure',\n  crystal = 'crystal',\n  csp = 'csp',\n  cssExtras = 'css-extras',\n  d = 'd',\n  dart = 'dart',\n  diff = 'diff',\n  django = 'django',\n  docker = 'docker',\n  eiffel = 'eiffel',\n  elixir = 'elixir',\n  elm = 'elm',\n  erb = 'erb',\n  erlang = 'erlang',\n  fsharp = 'fsharp',\n  flow = 'flow',\n  fortran = 'fortran',\n  gedcom = 'gedcom',\n  gherkin = 'gherkin',\n  git = 'git',\n  glsl = 'glsl',\n  go = 'go',\n  graphql = 'graphql',\n  groovy = 'groovy',\n  haml = 'haml',\n  handlebars = 'handlebars',\n  haskell = 'haskell',\n  haxe = 'haxe',\n  http = 'http',\n  hpkp = 'hpkp',\n  hsts = 'hsts',\n  ichigojam = 'ichigojam',\n  icon = 'icon',\n  inform7 = 'inform7',\n  ini = 'ini',\n  io = 'io',\n  j = 'j',\n  java = 'java',\n  jolie = 'jolie',\n  json = 'json',\n  jsx = 'jsx',\n  julia = 'julia',\n\n  keyman = 'keyman',\n  kotlin = 'kotlin',\n  latex = 'latex',\n  less = 'less',\n  lilypond = 'lilypond',\n  liquid = 'liquid',\n  lisp = 'lisp',\n  livescript = 'livescript',\n  lolcode = 'lolcode',\n  lua = 'lua',\n  makefile = 'makefile',\n  markdown = 'markdown',\n  markupTemplating = 'markup-templating',\n  matlab = 'matlab',\n  mel = 'mel',\n  mizar = 'mizar',\n  monkey = 'monkey',\n  n4js = 'n4js',\n  nasm = 'nasm',\n  nginx = 'nginx',\n  nim = 'nim',\n  nix = 'nix',\n  nsis = 'nsis',\n  objectivec = 'objectivec',\n  ocaml = 'ocaml',\n  opencl = 'opencl',\n  oz = 'oz',\n  parigp = 'parigp',\n  parser = 'parser',\n  pascal = 'pascal',\n  perl = 'perl',\n  php = 'php',\n  phpExtras = 'php-extras',\n  plsql = 'plsql',\n  powershell = 'powershell',\n  processing = 'processing',\n  prolog = 'prolog',\n  properties = 'properties',\n  protobuf = 'protobuf',\n  pug = 'pug',\n  puppet = 'puppet',\n  pure = 'pure',\n  python = 'python',\n  q = 'q',\n  qore = 'qore',\n  r = 'r',\n}\n\n\n/**\n * @name Code Highlighter\n * @description A browser based code highlighter.\n * @img /assets/img/code-highlighter.png\n */\n@Component({\n  tag: 'goat-code-highlighter',\n  styleUrl: 'code-highlighter.scss',\n  shadow: true,\n})\nexport class CodeHighlighter implements ComponentInterface {\n\n\n  @Prop() language: string = Language.javascript;\n\n  @Prop() lineNumbers: boolean = false;\n\n  @Prop() value: string = '';\n\n  @State() compiledCode: string = '';\n\n  private parsedValue: string = '';\n\n  @Watch('language')\n  languageWatcher() {\n    this.renderPrism();\n  }\n\n  @Watch('lineNumbers')\n  themeWatcher() {\n    this.renderPrism();\n  }\n\n\n  @Element() elm!: HTMLElement;\n\n  async componentWillLoad() {\n    if (!window['Prism']) {\n      await loadPrism();\n      // @ts-ignore\n      const Prism = window['Prism'];\n      const autoloader = Prism.plugins.autoloader;\n      if (autoloader) {\n        const all = [];\n        for (const key in Language) {\n          all.push(Language[key]);\n        }\n        autoloader.loadLanguages(all);\n      }\n    }\n  }\n\n  componentDidLoad() {\n    setTimeout(() => this.renderPrism(), 1000);\n  }\n\n  decode(str: string) {\n    return str.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n  }\n\n  private renderPrism() {\n    // @ts-ignore\n    const Prism = window['Prism'];\n\n    let value = this.value;\n    if (!value) {\n      value = this.elm.innerHTML;\n    }\n    value = this.decode(value);\n    this.parsedValue = value.trim();\n    const formatted = Prism.highlight(this.parsedValue, Prism.languages[this.language], this.language);\n    let lineNumbersWrapper = '';\n    if (this.lineNumbers) {\n      const linesNum = formatted.split('\\n').length;\n      const lines = new Array(linesNum + 1).join('<span></span>');\n      lineNumbersWrapper = `<span aria-hidden='true' class='line-numbers-rows'>${lines}</span>`;\n    }\n    this.compiledCode = formatted + lineNumbersWrapper;\n  }\n\n  handleCopyClick() {\n    window.navigator.clipboard.writeText(this.parsedValue);\n    alert('copied');\n  }\n\n  render() {\n    return (\n      <Host>\n        {this.compiledCode && <div class='code-highlighter'>\n          <div class='scroll-wrapper'>\n            <div class={{ 'line-numbers-wrapper': true, 'line-numbers': this.lineNumbers }}>\n              <pre dir='ltr' class='highlighter line-numbers' innerHTML={this.compiledCode} />\n            </div>\n          </div>\n          <goat-button class='copy-btn color-secondary icon-only'\n                       size='sm'\n                       variant='ghost'\n                       aria-label='Copy code'\n                       title='Copy code' onGoat:click={() => {\n            this.handleCopyClick();\n          }}>\n            <goat-icon name='files' size='1rem' />\n          </goat-button>\n\n        </div>}\n        {!this.compiledCode && <div class='code-loader'>\n          <goat-spinner class='rainbow' />\n          Loading code...\n        </div>}\n      </Host>\n    );\n  }\n\n}\n"]}